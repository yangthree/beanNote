<view class="page">
  <login-dialog
    show="{{showLoginDialog}}"
    closable="{{false}}"
    defaultAvatar="{{userProfile ? userProfile.avatarUrl : ''}}"
    defaultNickName="{{userProfile ? userProfile.nickName : ''}}"
    bind:success="onLoginSuccess"
    bind:close="onLoginDialogClose"
  />

  <view class="form-section">
    <view class="form-item">
      <view class="label">设备类型 *</view>
      <picker
        mode="selector"
        range="{{typeOptions}}"
        range-key="label"
        value="{{typeIndex}}"
        bindchange="onTypeChange"
      >
        <view class="picker-value">{{typeOptions[typeIndex].label}}</view>
      </picker>
    </view>

    <view class="form-item">
      <view class="label">设备名称 *</view>
      <input
        class="input"
        placeholder="如：V60 手冲壶"
        value="{{form.name}}"
        data-field="name"
        bindinput="onInputChange"
      />
    </view>

    <view class="form-item">
      <view class="label">品牌 *</view>
      <input
        class="input"
        placeholder="如：Hario"
        value="{{form.brand}}"
        data-field="brand"
        bindinput="onInputChange"
      />
    </view>

    <view class="form-item">
      <view class="label">型号 / 备注</view>
      <input
        class="input"
        placeholder="如：02 / 树脂款"
        value="{{form.model}}"
        data-field="model"
        bindinput="onInputChange"
      />
    </view>

    <view class="form-item inline">
      <view class="label">设为默认</view>
      <switch checked="{{form.isDefault}}" bindchange="onDefaultChange" />
    </view>
  </view>

  <view class="tips-card">
    <view class="tips-title">提示</view>
    <view class="tips-text">
      不同类型的设备可以分别设置默认，下次记录相应的冲煮方式时会自动带入。
    </view>
  </view>

  <view class="footer">
    <button
      class="danger-btn"
      wx:if="{{isEdit}}"
      bindtap="handleDelete"
    >删除设备</button>
    <button
      class="primary-btn"
      bindtap="handleSubmit"
    >{{isEdit ? '保存修改' : '保存设备'}}</button>
  </view>
</view>

