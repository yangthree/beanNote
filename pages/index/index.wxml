<!-- pages/index/index.wxml -->
<!-- æˆ‘çš„è±†å•é¦–é¡µï¼šå±•ç¤ºä¸ªäººè±†å•åˆ—è¡¨ï¼Œå¹¶æä¾›æœç´¢ä¸æ–°å¢å…¥å£ -->
<view class="page">
  <!-- é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸ -->
  <view class="header">
    <view class="header-title">æˆ‘çš„è±†å•</view>
  </view>

  <!-- æœç´¢è¾“å…¥æ¡† -->
  <view class="search-container">
    <text class="search-icon">ğŸ”</text>
    <input
      class="search-input"
      placeholder="æœç´¢è±†åã€å“ç‰Œã€äº§åœ°æˆ–é£å‘³..."
      placeholder-style="color:#888888"
      value="{{searchKeyword}}"
      bindinput="onSearchInput"
    />
  </view>

  <!-- ç­›é€‰æ§ä»¶ï¼ˆSegmented Controlï¼‰ -->
  <view class="filter-container">
    <view 
      class="filter-item {{filterType === 'all' ? 'active' : ''}}"
      data-type="all"
      bindtap="onFilterTypeChange"
    >
      å…¨éƒ¨
    </view>
    <view 
      class="filter-item {{filterType === 'pourOver' ? 'active' : ''}}"
      data-type="pourOver"
      bindtap="onFilterTypeChange"
    >
      æ‰‹å†²
    </view>
    <view 
      class="filter-item {{filterType === 'espresso' ? 'active' : ''}}"
      data-type="espresso"
      bindtap="onFilterTypeChange"
    >
      æ„å¼
    </view>
  </view>

  <!-- åˆ—è¡¨åŒºåŸŸ -->
  <block wx:if="{{showEmpty}}">
    <!-- ç©ºçŠ¶æ€ï¼šæ— è®°å½•æ—¶ç»™å‡ºå¼•å¯¼ -->
    <view class="empty-state">
      <text class="empty-title">è¿˜æ²¡æœ‰å’–å•¡è±†è®°å½•\n</text>
      <text class="empty-hint">ç‚¹å‡»ä¸‹æ–¹â€œ+â€æŒ‰é’®å¼€å§‹è®°å½•</text>
    </view>
  </block>
  <block wx:else>
    <view class="bean-list">
      <view
        class="bean-card"
        wx:for="{{coffeeBeans}}"
        wx:key="id"
        bindtap="goToDetail"
        bindlongpress="showDeleteMenu"
        data-id="{{item.id}}"
      >
        <!-- å›¾ç‰‡å°é¢ï¼šæ˜¾ç¤ºè±†è¢‹å›¾ç‰‡æˆ–å ä½ -->
        <view class="bean-image-wrapper">
          <image
            wx:if="{{item.coverImage}}"
            class="bean-image"
            src="{{item.coverImage}}"
            mode="aspectFill"
          />
          <view wx:else class="bean-image-placeholder">â˜•</view>
          <view class="bean-badge">{{item.type === 'pourOver' ? 'æ‰‹å†²' : 'æ„å¼'}}/{{item.roastLevel}}</view>
          <view class="bean-price" wx:if="{{item.displayPricePer100g}}">{{item.displayPricePer100g}}</view></view>

        <!-- å†…å®¹åŒº -->
        <view class="bean-content">
          <!-- ç¬¬ä¸€è¡Œï¼šè±†å + å“ç‰Œ -->
          <view class="bean-title-row">
            <text class="bean-name">{{item.name || 'æœªå‘½åå’–å•¡è±†'}}</text>
            <text class="bean-brand" wx:if="{{item.brand}}">{{item.brand}}</text>
          </view>

          <!-- ç¬¬äºŒè¡Œï¼šäº§åœ° + è¯„åˆ† -->
          <view class="bean-info-row">
            <text class="bean-origin" wx:if="{{item.origin}}">{{item.origin}}</text>
            <view class="bean-rating">
              <text class="star active">â˜…</text>
              <text class="rating-value">{{item.displayRating}}</text>
            </view>
          </view>

          <!-- ç¬¬ä¸‰è¡Œï¼šå¤„ç†æ³• + ä¸Šä¼ æ—¥æœŸ -->
          <view class="bean-info-row">
            <text class="bean-process" wx:if="{{item.processMethod}}">{{item.processMethod}}</text>
            <text class="bean-date" wx:if="{{item.displayDate}}">{{item.displayDate}}</text>
          </view>
        </view>
      </view>
    </view>
  </block>

  <!-- æ‚¬æµ®æ–°å¢æŒ‰é’® -->
  <view class="fab" bindtap="goToAdd">
    <text class="fab-icon">ï¼‹</text>
  </view>
</view>
